{% extends "base.html" %} {% block title %}Lost Items - {{ title }}{% endblock
%} {% block content %}
<div class="card">
  <h2>üîç Lost Items</h2>
  <p>
    Here are all the reported lost items. Click on any item to view details or
    claim it if it belongs to you.
  </p>
</div>

{% if items %}
<div class="item-grid">
  {% for item in items %}
  <div
    class="item-card {% if item.status == 'claimed' %}status-claimed{% elif item.status == 'returned' %}status-returned{% endif %}"
  >
    {% if item.image_filename %}
    <div style="margin-bottom: 15px; overflow: hidden; border-radius: 8px">
      <img
        src="{{ url_for('uploaded_file', filename=item.image_filename) }}"
        style="width: 100%; height: 180px; object-fit: cover"
        alt="{{ item.item_name }}"
      />
    </div>
    {% endif %}
    <div class="item-title">{{ item.item_name }}</div>

    <div class="item-meta"><strong>Category:</strong> {{ item.category }}</div>

    <div class="item-meta">
      <strong>Lost Date:</strong> {{ item.lost_date }}
    </div>

    <div class="item-meta"><strong>Location:</strong> {{ item.location }}</div>

    <div class="item-meta">
      <strong>Contact:</strong> {{ item.contact_name }}{% if item.contact_phone
      %} - {{ item.contact_phone }}{% endif %}
    </div>

    {% if item.description %}
    <div class="item-description">
      <strong>Description:</strong> {{ item.description }}
    </div>
    {% endif %}

    <div class="item-meta">
      <span class="status-badge status-{{ item.status }}"
        >{{ item.status }}</span
      >
      <small style="margin-left: 10px; color: #666"
        >Reported on: {{ item.created_at[:10] }}</small
      >
    </div>

    <div style="margin-top: 15px; display: flex; gap: 10px; flex-wrap: wrap;">
      <a href="{{ url_for('view_lost_item', item_id=item.id) }}" class="btn"
        >View Details</a
      >
      {% if item.status == 'unclaimed' %}
      <a
        href="{{ url_for('claim_lost_item', item_id=item.id) }}"
        class="btn btn-success"
        >Claim Item</a
      >
      {% endif %}
      <!-- Delete button (only for admin or item reporter) -->
      {% if session and ('user_role' in session and session.user_role == 'admin') or ('user_id' in session and session.user_id == item.user_id) %}
      <form method="POST" action="{{ url_for('delete_lost', item_id=item.id) }}" style="margin: 0;">
        <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this item?')">
          Delete
        </button>
      </form>
      {% endif %}
    </div>
  </div>
  {% endfor %}
</div>
{% else %}
<div class="card">
  <h3>No Lost Items Found</h3>
  <p>
    There are currently no reported lost items. Be the first to report a lost
    item!
  </p>
  <div style="text-align: center; margin-top: 20px">
    <a href="{{ url_for('report_lost') }}" class="btn btn-warning"
      >Report a Lost Item</a
    >
  </div>
</div>
{% endif %}

<div style="text-align: center; margin-top: 30px">
  <a href="{{ url_for('index') }}" class="btn">‚Üê Back to Home</a>
</div>
{% endblock %}
